---
title : C++-어트리뷰트 시스템 설계
date : 2024-12-23 06:00:00
author: <ByteFries>
description : "C++"
categories : [C++]]
tags : [C++]
comments : true
toc : true
---

#include <unordered_map>
using namespace std;

class Stat
{
public:
    Stat(float initialValue = 0) : value(initialValue) {}
    virtual ~Stat() = default;

    virtual void ApplyModifier(float value) = 0;
    virtual float GetValue() const = 0;
    virtual void Increase(int value = 1) = 0;
    virtual void ApplyLevelUp(int level = 1) = 0;

protected:
    float value;
};

class StatModifier : public Stat
{
public:
	virtual void ApplyEffect(StatManager& manager) const abstract;
	virtual ~StatModifier() {}
};

class BuffModifier : public StatModifier
{
public:
    BuffModifier(float duration)
        : duration(duration) {}

    void ApplyEffect(StatManager& manager) const override
    {
        // 스탯에 버프 효과 적용
    }

    void Update(float deltaTime)
    {
        duration -= deltaTime;
        if (duration <= 0)
        {
            isExpired = true;
        }
    }

    bool IsExpired() const { return isExpired; }

private:
    float duration;
    bool isExpired = false;
};

class EquipmentModifier : public StatModifier
{
public:
    EquipmentModifier(const std::unordered_map<StatType, float>& effects)
        : effects(effects) {}

    void ApplyEffect(StatManager& manager) const override
    {
        for (const auto& [type, value] : effects)
        {
            auto stat = manager.GetStat(type);
            if (stat)
            {
                stat->ApplyModifier(value);
            }
        }
    }
};

enum class StatType
{
	HP,
	MP,
	STR,
	INT,
	LUCK,
	DEF
};

class StatManager
{
public:
	StatManager() = default;
	~StatManager() = default;

	virtual void LevelUp() abstract;

	void IncreaseStatWithPoints(StatType type, int point = 1)
	{
		auto stat = GetStat(type);
		
		if (stat != nullptr)
		{
			stat->Increase(point);
		}
	}


	Stat* GetStat(StatType type)
	{
		if (stats.end() != stats.find(type))
		{
			return stats[type];
		}

		return nullptr;
	}


protected:
	unordered_map<StatType, Stat*> stats;
};
